{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '41929630-0ce2e4f7023522073d7143cb8';\n\nconst refs = {\n  form: document.getElementById('form'),\n  resultContainer: document.getElementById('result-container'),\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.getElementById('load-more'),\n};\n\nconst queryParams = {\n  query: '',\n  page: 1,\n  pageSize: 40,\n  maxPage: 0,\n};\n\nrefs.form.addEventListener('submit', handleSearch);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n\n  refs.resultContainer.innerHTML = '';\n  queryParams.page = 1;\n  refs.loader.classList.remove('is-hidden');\n  refs.loadMoreBtn.classList.add('is-hidden');\n\n  const form = event.currentTarget;\n  queryParams.query = form.elements.picture.value.trim();\n\n  if (!queryParams.query) {\n    refs.loader.classList.add('is-hidden');\n    return;\n  }\n\n  try {\n    const { hits, totalHits } = await searchPicturesByParam(queryParams);\n\n    if (hits.length === 0) {\n      iziToast.error({\n        position: 'topRight',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n    }\n\n    queryParams.maxPage = Math.ceil(totalHits / queryParams.pageSize);\n    createMarkup(hits);\n\n    if (hits.length > 0 && hits.length !== totalHits) {\n      refs.loadMoreBtn.classList.remove('is-hidden');\n      refs.loadMoreBtn.addEventListener('click', loadMoreSearch);\n    }\n    \n    if (queryParams.page === queryParams.maxPage) {\n      refs.loadMoreBtn.classList.add('is-hidden');\n      refs.loadMoreBtn.removeEventListener('click', loadMoreSearch);\n      iziToast.info({\n        position: 'topRight',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } catch (err) {\n    iziToast.error({ position: 'topRight', message: 'Something wrong!' });\n  } finally {\n    form.reset();\n    refs.loader.classList.add('is-hidden');\n  }\n\n  async function loadMoreSearch() {\n    queryParams.page += 1;\n    refs.loadMoreBtn.disabled = true;\n    refs.loader.classList.remove('is-hidden');\n\n    try {\n      const { hits } = await searchPicturesByParam(queryParams);\n      createMarkup(hits);\n      skrollDown();\n    } catch {\n      iziToast.error({ position: 'topRight', message: 'Something wrong!' });\n    } finally {\n      refs.loadMoreBtn.disabled = false;\n      refs.loader.classList.add('is-hidden');\n    }\n\n    if (queryParams.page === queryParams.maxPage) {\n      refs.loadMoreBtn.classList.add('is-hidden');\n      refs.loadMoreBtn.removeEventListener('click', loadMoreSearch);\n      iziToast.info({\n        position: 'topRight',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  }\n}\n\nfunction searchPicturesByParam({ query, page = 1, pageSize }) {\n  return axios\n    .get(`${BASE_URL}`, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: pageSize,\n        page,\n      },\n    })\n    .then(({ data }) => data);\n}\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction createMarkup(pictures) {\n  const markUp = pictures\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"gallery-item\">\n            <a href=\"${largeImageURL}\">\n  <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"370\" heigth=\"300\"></a>\n  <ul class=\"info-list\">\n    <li class=\"info-item\">Likes: ${likes}</li>\n    <li class=\"info-item\">Views: ${views}</li>\n    <li class=\"info-item\">Comments: ${comments}</li>\n    <li class=\"info-item\">Downloads: ${downloads}</li>\n  </ul>\n</li>`\n    )\n    .join('');\n  refs.resultContainer.insertAdjacentHTML('beforeend', markUp);\n  lightbox.refresh();\n}\n\nfunction skrollDown() {\n  if (queryParams.page > 1) {\n    const rectItem = document\n      .querySelector('.gallery-item')\n      .getBoundingClientRect();\n    window.scrollBy({ top: rectItem.height * 2, left: 0, behavior: 'smooth' });\n  }\n}\n"],"names":["BASE_URL","API_KEY","refs","queryParams","handleSearch","event","form","hits","totalHits","searchPicturesByParam","iziToast","createMarkup","loadMoreSearch","skrollDown","query","page","pageSize","axios","data","lightbox","SimpleLightbox","pictures","markUp","webformatURL","largeImageURL","tags","likes","views","comments","downloads","rectItem"],"mappings":"owBAMA,MAAMA,EAAW,2BACXC,EAAU,qCAEVC,EAAO,CACX,KAAM,SAAS,eAAe,MAAM,EACpC,gBAAiB,SAAS,eAAe,kBAAkB,EAC3D,OAAQ,SAAS,cAAc,SAAS,EACxC,YAAa,SAAS,eAAe,WAAW,CAClD,EAEMC,EAAc,CAClB,MAAO,GACP,KAAM,EACN,SAAU,GACV,QAAS,CACX,EAEAD,EAAK,KAAK,iBAAiB,SAAUE,CAAY,EAEjD,eAAeA,EAAaC,EAAO,CACjCA,EAAM,eAAc,EAEpBH,EAAK,gBAAgB,UAAY,GACjCC,EAAY,KAAO,EACnBD,EAAK,OAAO,UAAU,OAAO,WAAW,EACxCA,EAAK,YAAY,UAAU,IAAI,WAAW,EAE1C,MAAMI,EAAOD,EAAM,cAGnB,GAFAF,EAAY,MAAQG,EAAK,SAAS,QAAQ,MAAM,OAE5C,CAACH,EAAY,MAAO,CACtBD,EAAK,OAAO,UAAU,IAAI,WAAW,EACrC,MACD,CAED,GAAI,CACF,KAAM,CAAE,KAAAK,EAAM,UAAAC,CAAS,EAAK,MAAMC,EAAsBN,CAAW,EAE/DI,EAAK,SAAW,GAClBG,EAAS,MAAM,CACb,SAAU,WACV,QACE,0EACV,CAAO,EAGHP,EAAY,QAAU,KAAK,KAAKK,EAAYL,EAAY,QAAQ,EAChEQ,EAAaJ,CAAI,EAEbA,EAAK,OAAS,GAAKA,EAAK,SAAWC,IACrCN,EAAK,YAAY,UAAU,OAAO,WAAW,EAC7CA,EAAK,YAAY,iBAAiB,QAASU,CAAc,GAGvDT,EAAY,OAASA,EAAY,UACnCD,EAAK,YAAY,UAAU,IAAI,WAAW,EAC1CA,EAAK,YAAY,oBAAoB,QAASU,CAAc,EAC5DF,EAAS,KAAK,CACZ,SAAU,WACV,QAAS,4DACjB,CAAO,EAEJ,MAAC,CACAA,EAAS,MAAM,CAAE,SAAU,WAAY,QAAS,kBAAkB,CAAE,CACxE,QAAY,CACRJ,EAAK,MAAK,EACVJ,EAAK,OAAO,UAAU,IAAI,WAAW,CACtC,CAED,eAAeU,GAAiB,CAC9BT,EAAY,MAAQ,EACpBD,EAAK,YAAY,SAAW,GAC5BA,EAAK,OAAO,UAAU,OAAO,WAAW,EAExC,GAAI,CACF,KAAM,CAAE,KAAAK,CAAM,EAAG,MAAME,EAAsBN,CAAW,EACxDQ,EAAaJ,CAAI,EACjBM,GACN,MAAM,CACAH,EAAS,MAAM,CAAE,SAAU,WAAY,QAAS,kBAAkB,CAAE,CAC1E,QAAc,CACRR,EAAK,YAAY,SAAW,GAC5BA,EAAK,OAAO,UAAU,IAAI,WAAW,CACtC,CAEGC,EAAY,OAASA,EAAY,UACnCD,EAAK,YAAY,UAAU,IAAI,WAAW,EAC1CA,EAAK,YAAY,oBAAoB,QAASU,CAAc,EAC5DF,EAAS,KAAK,CACZ,SAAU,WACV,QAAS,4DACjB,CAAO,EAEJ,CACH,CAEA,SAASD,EAAsB,CAAE,MAAAK,EAAO,KAAAC,EAAO,EAAG,SAAAC,CAAQ,EAAI,CAC5D,OAAOC,EACJ,IAAI,GAAGjB,IAAY,CAClB,OAAQ,CACN,IAAKC,EACL,EAAGa,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUE,EACV,KAAAD,CACD,CACP,CAAK,EACA,KAAK,CAAC,CAAE,KAAAG,CAAM,IAAKA,CAAI,CAC5B,CAEA,IAAIC,EAAW,IAAIC,EAAe,aAAc,CAC9C,aAAc,MACd,aAAc,GAChB,CAAC,EAED,SAAST,EAAaU,EAAU,CAC9B,MAAMC,EAASD,EACZ,IACC,CAAC,CACC,aAAAE,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA,uBACWL;AAAA,oCACaD,WAAsBE;AAAA;AAAA,mCAEvBC;AAAA,mCACAC;AAAA,sCACGC;AAAA,uCACCC;AAAA;AAAA,MAGlC,EACA,KAAK,EAAE,EACV3B,EAAK,gBAAgB,mBAAmB,YAAaoB,CAAM,EAC3DH,EAAS,QAAO,CAClB,CAEA,SAASN,GAAa,CACpB,GAAIV,EAAY,KAAO,EAAG,CACxB,MAAM2B,EAAW,SACd,cAAc,eAAe,EAC7B,wBACH,OAAO,SAAS,CAAE,IAAKA,EAAS,OAAS,EAAG,KAAM,EAAG,SAAU,QAAU,CAAA,CAC1E,CACH"}